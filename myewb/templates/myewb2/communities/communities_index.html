{% extends "communities/base.html" %}

{% load i18n %}
{% load uni_form_tags %}
{% load humanize %}
{% load pagination_tags %}
{% load order_by %}
{% load extra_tagging_tags %}
{% load communities_tags %}
{% load base_groups_tags %}
{% load sorting_tags %}
{% load cache %}

{% block head_title %}{% blocktrans %}Communities{% endblocktrans %}{% endblock %}

{% block body %}

{% cache CACHE_TIMEOUT "communitylist" user request.page request.field search_terms %}

    <h1 class="h2bold">{% trans "My Groups" %}</h1>
    
    <div class="chapterlist communitieslist">

	    {% if user.is_authenticated and user.get_networks %}
		    {% for group in user.get_communities %}
	            {% show_community group %}
			{% endfor %}
	
	    {% else %}
	        {% url acct_signup as signup_url %}
	        {% url acct_login as login_url %}
	        <p>Not much to see here...</p>
	        <p>You should really <a href="{{ login_url }}">log in </a>.</p>
		{% endif %}
	    
    </div>
	
{% endcache %}

{% endblock %}


{% block toolbar_left %}
{% endblock %}



{% block toolbar_right %}

	<div class="toolbarheader bkgd" id="box-search-communities">{% trans "Search groups" %}</div>
			<div class="toolbarcontent">
	
	    <form method="GET" action="">
	        <input type="text" name="search" value="{{ search_terms }}" />
	        <input type="submit" value="Search" />
	        {% if search_terms %}
	            <br/><a href="{% clear_search_url request %}">Clear Search Terms</a>
	        {% endif %}
	    </form>
	</div>


    {% if user.is_authenticated %}
		<div class="toolbarheader bkgd" id="box-create-communities">{% trans "Create" %}</div>
				<div class="toolbarcontent">
				You can create new communities and invite members to contribute.
		        <p><a href="{% url new_community %}">Create a new community</a></p>
		</div>
	{% else %}
		<div class="toolbarheader bkgd" id="box-about-communities">{% trans "About EWB Communities" %}</div>
		<div class="toolbarcontent">
		myEWB communities are where EWB members come together to discuss issues important to them and to the organization.  Any logged-in myEWB member can also create new communities. Sign in, create a community of your own, and share it with others!
		</div>
	{% endif %}

	<div class="toolbarheader bkgd" id="box-my-communities">{% trans "Active Groups" %}</div>
	<div class="toolbarcontent">
	    {% autosort groups %}
	    {% autopaginate groups 10 %}
	    {% if groups %}
	    
	        {% for group in groups %}
				<div style="padding-bottom: 4px;">
					<a href="{% url group_detail group.slug %}">{{ group.name }}</a>
				</div>
	        {% endfor %}
	        
	    {% endif %}
	</div>



{% endblock %}
